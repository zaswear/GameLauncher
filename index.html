<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameLauncher Pro üöÄ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Fuentes de Google para una mejor tipograf√≠a */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');

        /* Estilo personalizado para la tabla y el scroll */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Fondo oscuro tipo GitHub */
            color: #e6e6e6;
            padding: 0;
            margin: 0;
        }
        /* Estilo para hacer la tabla editable m√°s visible */
        [contenteditable]:focus {
            outline: 2px solid #5778ff; /* Borde azul brillante al editar */
            background-color: #1a222c;
            border-radius: 4px;
        }
        /* Estilo para la columna de T√≠tulo (clickable) */
        .title-cell {
            cursor: pointer;
            color: #818cf8; /* Indigo 400 */
            text-decoration: none;
            font-weight: bold;
            transition: color 0.2s ease-in-out;
        }
        .title-cell:hover {
            color: #a5b4fc; /* Indigo 300 */
            text-decoration: underline;
        }
        /* Barra de desplazamiento estilo "neon" */
        .scroll-container::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .scroll-container::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #4f46e5, #7c3aed);
            border-radius: 10px;
        }
        .scroll-container::-webkit-scrollbar-track {
            background: #1a222c;
        }
        /* Efecto hover en filas con transici√≥n suave */
        .data-row:hover {
            background-color: #161b22;
        }
        /* Estilo para el bot√≥n de carga */
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #818cf8;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Animaci√≥n de entrada para el panel de detalles */
        .details-panel-enter {
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="mb-8 p-4 bg-gray-900/50 backdrop-blur-sm border border-gray-700 rounded-xl shadow-2xl">
            <h1 class="text-3xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-500 mb-2">
                üöÄ GameLauncher Pro
            </h1>
            <p class="text-gray-400">Tu radar de pr√≥ximos lanzamientos. ID de Sesi√≥n: <span id="user-id-display" class="font-mono text-xs bg-gray-700 px-2 py-0.5 rounded">Cargando...</span></p>
        </header>

        <div class="mb-6 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
            <input type="text" id="search-input" placeholder="Buscar por t√≠tulo o plataforma..."
                   class="w-full md:w-80 p-3 rounded-lg bg-gray-800 text-white border-2 border-gray-700 focus:border-indigo-500 transition duration-200 focus:ring-2 focus:ring-indigo-500"
                   oninput="filterTable()">
            <button id="add-row-btn" class="bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-200 transform hover:scale-105 flex items-center space-x-2" onclick="addNewRow()">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                </svg>
                <span>A√±adir Juego</span>
            </button>
        </div>

        <div id="loading-indicator" class="text-center py-10 text-lg text-indigo-400 hidden">
            Cargando lanzamientos desde la base de datos... <span class="spinner inline-block ml-2"></span>
        </div>
        <div id="error-message" class="hidden bg-red-800 p-4 rounded-lg mb-4 text-sm"></div>

        <div class="scroll-container overflow-x-auto rounded-xl shadow-2xl border border-gray-700">
            <table class="min-w-full divide-y divide-gray-700">
                <thead class="bg-gray-800 sticky top-0">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">T√≠tulo (Click p/ Detalles)</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Plataformas</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Fecha Estreno</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">G√©nero</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">üìå Notas (Editable)</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">‚ùå</th>
                    </tr>
                </thead>
                <tbody id="game-table-body" class="bg-gray-900 divide-y divide-gray-700">
                    </tbody>
            </table>
        </div>

        <div id="details-panel" class="hidden mt-8 p-6 bg-gray-800/60 backdrop-blur-sm border border-gray-700 rounded-xl shadow-2xl">
            </div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, deleteDoc, onSnapshot, collection, query, addDoc, getDocs, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Establecer nivel de log para depuraci√≥n de Firestore
        setLogLevel('error'); // Cambiar a 'debug' si necesitas ver m√°s detalles en consola

        // --- Configuraci√≥n e Inicializaci√≥n de Firebase (NO EDITAR) ---
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db;
        let auth;
        let userId = 'local-user'; // ID por defecto para modo offline
        let gamesData = [];
        let activeDetailsId = null; // ID del juego cuyos detalles est√°n abiertos

        // --- DATOS REALES DE PR√ìXIMOS LANZAMIENTOS (Oct 2025 - 2026) ---
        const initialGames = [
            // Octubre 2025
            { id: 'g001', title: "Call of Duty: Black Ops 6", platforms: "PC, PS5, XSX, PS4, XBO", releaseDate: "25 Oct 2025", genre: "FPS", notes: "Regreso de la saga Black Ops, ambientado en la Guerra del Golfo.", steamLink: "https://store.steampowered.com/app/1962663/Call_of_Duty_Black_Ops_6/", ps5Link: "https://store.playstation.com/es-es/concept/10005574", xboxLink: "https://www.xbox.com/es-es/games/store/call-of-duty-black-ops-6/9P2S135G0X5C", ggDealsLink: "https://gg.deals/game/call-of-duty-black-ops-6/", instantGamingLink: "https://www.instant-gaming.com/es/16631-comprar-call-of-duty-black-ops-6-pc-juego-battle-net/" },
            { id: 'g002', title: "Silent Hill 2 (Remake)", platforms: "PC, PS5", releaseDate: "08 Oct 2025", genre: "Survival Horror", notes: "Remake del cl√°sico de terror psicol√≥gico por Bloober Team.", steamLink: "https://store.steampowered.com/app/2124490/SILENT_HILL_2/", ps5Link: "https://store.playstation.com/es-es/concept/10005329", xboxLink: null, ggDealsLink: "https://gg.deals/game/silent-hill-2-remake/", instantGamingLink: "https://www.instant-gaming.com/es/13309-comprar-silent-hill-2-remake-pc-juego-steam/" },
            { id: 'g003', title: "New World: Aeternum", platforms: "PS5, XSX", releaseDate: "15 Oct 2025", genre: "MMORPG", notes: "Versi√≥n para consolas del MMO de Amazon, con contenido expandido.", steamLink: null, ps5Link: "https://store.playstation.com/es-es/concept/10010375", xboxLink: "https://www.xbox.com/es-ES/games/store/new-world-aeternum-deluxe-edition/9P9D7G51B923", ggDealsLink: "https://gg.deals/game/new-world-aeternum/", instantGamingLink: null },
            
            // Noviembre 2025
            { id: 'g004', title: "Assassin's Creed Shadows", platforms: "PC, PS5, XSX", releaseDate: "15 Nov 2025", genre: "Action RPG", notes: "Ambientado en el Jap√≥n Feudal, con un shinobi y un samur√°i como protagonistas.", steamLink: null, ps5Link: "https://store.playstation.com/es-es/concept/10008947", xboxLink: "https://www.xbox.com/es-ES/games/store/assassins-creed-shadows/9P36814M9H2D", ggDealsLink: "https://gg.deals/game/assassins-creed-shadows/", instantGamingLink: "https://www.instant-gaming.com/es/16544-comprar-assassin-s-creed-shadows-pc-juego-ubisoft-connect/" },

            // Q4 2025 (Fechas por confirmar)
            { id: 'g005', title: "Grand Theft Auto VI", platforms: "PS5, XSX", releaseDate: "Oto√±o 2025", genre: "Action-Adventure", notes: "El juego m√°s esperado de la d√©cada. Regreso a Vice City.", steamLink: null, ps5Link: null, xboxLink: null, ggDealsLink: "https://gg.deals/game/grand-theft-auto-vi/", instantGamingLink: null },
            { id: 'g006', title: "Death Stranding 2: On The Beach", platforms: "PS5", releaseDate: "Finales 2025", genre: "Action", notes: "Secuela de la obra de Hideo Kojima, expandiendo su universo √∫nico.", steamLink: null, ps5Link: "https://store.playstation.com/es-es/concept/10008596", xboxLink: null, ggDealsLink: "https://gg.deals/game/death-stranding-2-on-the-beach/", instantGamingLink: null },
            
            // 2026
            { id: 'g007', title: "STALKER 2: Heart of Chornobyl", platforms: "PC, XSX", releaseDate: "05 Dic 2025", genre: "FPS Survival Horror", notes: "Exploraci√≥n post-apocal√≠ptica en la Zona de Exclusi√≥n de Chern√≥bil.", steamLink: "https://store.steampowered.com/app/1643320/STALKER_2_Heart_of_Chornobyl/", ps5Link: null, xboxLink: "https://www.xbox.com/es-es/games/store/s-t-a-l-k-e-r-2-heart-of-chornobyl/9p2v5f733z2n", ggDealsLink: "https://gg.deals/game/s-t-a-l-k-e-r-2-heart-of-chernobyl/", instantGamingLink: "https://www.instant-gaming.com/es/9017-comprar-s-t-a-l-k-e-r-2-heart-of-chornobyl-pc-juego-steam/" },
            { id: 'g008', title: "Fable (Reboot)", platforms: "PC, XSX", releaseDate: "TBA 2026", genre: "Action RPG", notes: "El regreso de la m√≠tica saga de rol y fantas√≠a por Playground Games.", steamLink: "https://store.steampowered.com/app/1042420/Fable/", ps5Link: null, xboxLink: "https://www.xbox.com/es-es/games/fable", ggDealsLink: "https://gg.deals/game/fable/", instantGamingLink: null },
            { id: 'g009', title: "The Witcher 4 (Polaris)", platforms: "PC, PS5, XSX", releaseDate: "TBA 2026", genre: "Open World RPG", notes: "Inicio de una nueva trilog√≠a en el universo de The Witcher con Unreal Engine 5.", steamLink: null, ps5Link: null, xboxLink: null, ggDealsLink: "https://gg.deals/game/the-witcher-4/", instantGamingLink: null },
            { id: 'g010', title: "Marvel's Wolverine", platforms: "PS5", releaseDate: "TBA 2026", genre: "Action", notes: "Juego de Insomniac Games centrado en Lobezno. Tono m√°s maduro.", steamLink: null, ps5Link: "https://store.playstation.com/es-es/concept/10003222", xboxLink: null, ggDealsLink: null, instantGamingLink: null },
            { id: 'g011', title: "Judas", platforms: "PC, PS5, XSX", releaseDate: "Principios 2026", genre: "FPS Narrativo", notes: "El nuevo juego del creador de BioShock, Ken Levine.", steamLink: "https://store.steampowered.com/app/1414680/Judas/", ps5Link: "https://store.playstation.com/es-es/concept/10006208", xboxLink: null, ggDealsLink: "https://gg.deals/game/judas/", instantGamingLink: null },
            { id: 'g012', title: "Monster Hunter Wilds", platforms: "PC, PS5, XSX", releaseDate: "TBA 2026", genre: "Action RPG", notes: "La pr√≥xima gran entrega de la saga de caza de monstruos de Capcom.", steamLink: "https://store.steampowered.com/app/2471920/Monster_Hunter_Wilds/", ps5Link: "https://store.playstation.com/es-es/concept/10009139", xboxLink: "https://www.xbox.com/es-es/games/store/monster-hunter-wilds/9P908H8XMJ08", ggDealsLink: "https://gg.deals/game/monster-hunter-wilds/", instantGamingLink: "https://www.instant-gaming.com/es/15599-comprar-monster-hunter-wilds-pc-juego-steam/" },
        ];


        // Funci√≥n de utilidad para manejar errores
        function displayError(message) {
            const errorElement = document.getElementById('error-message');
            errorElement.textContent = `Error: ${message}`;
            errorElement.classList.remove('hidden');
            setTimeout(() => errorElement.classList.add('hidden'), 8000);
            console.error(message);
        }

        // --- 1. Inicializaci√≥n y Autenticaci√≥n de Firebase ---
        async function initFirebase() {
            try {
                if (firebaseConfig) {
                    const app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);

                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                    
                    userId = auth.currentUser?.uid || crypto.randomUUID();
                    document.getElementById('user-id-display').textContent = userId;

                    listenForGames();

                } else {
                    console.warn("Configuraci√≥n de Firebase no disponible. La aplicaci√≥n funcionar√° en modo local. Los datos no ser√°n persistentes.");
                    document.getElementById('user-id-display').textContent = 'Modo Local';
                    gamesData = initialGames.map(g => ({ ...g, id: g.id || crypto.randomUUID() }));
                    renderTable(gamesData);
                }
            } catch (e) {
                displayError(`Fallo en la inicializaci√≥n de Firebase: ${e.message}`);
                gamesData = initialGames.map(g => ({ ...g, id: g.id || crypto.randomUUID() }));
                renderTable(gamesData);
            }
        }

        // --- 2. Rutas y Almacenamiento de Datos ---
        
        function getGamesCollectionRef() {
            if (!db) return null;
            const collectionPath = `artifacts/${appId}/users/${userId}/game_launch_data`;
            return collection(db, collectionPath);
        }

        async function checkAndLoadInitialData() {
            try {
                const q = query(getGamesCollectionRef());
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    console.log("No hay datos en Firestore. Cargando datos iniciales.");
                    for (const game of initialGames) {
                        const gameData = { ...game };
                        delete gameData.id;
                        await addDoc(getGamesCollectionRef(), gameData);
                    }
                } else {
                    console.log("Datos encontrados en Firestore. Saltando carga inicial.");
                }
            } catch (e) {
                console.error("Error al verificar/cargar datos iniciales:", e);
                displayError("No se pudieron cargar los datos iniciales en Firestore. Revisa la consola.");
            }
        }

        // --- 3. CRUD (Create, Read, Update, Delete) ---

        function listenForGames() {
            if (!getGamesCollectionRef()) return;

            const loadingIndicator = document.getElementById('loading-indicator');
            loadingIndicator.classList.remove('hidden');

            const q = query(getGamesCollectionRef());
            
            onSnapshot(q, (snapshot) => {
                loadingIndicator.classList.add('hidden');
                
                if (snapshot.metadata.hasPendingWrites === false && snapshot.docs.length === 0) {
                    checkAndLoadInitialData();
                    return;
                }

                gamesData = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                // Ordenar por fecha de lanzamiento
                gamesData.sort((a, b) => {
                    const dateA = new Date(a.releaseDate.replace("Oto√±o ", "10/01/").replace("Finales ", "11/01/").replace("Principios ", "02/01/").replace("TBA ", "12/31/"));
                    const dateB = new Date(b.releaseDate.replace("Oto√±o ", "10/01/").replace("Finales ", "11/01/").replace("Principios ", "02/01/").replace("TBA ", "12/31/"));
                    if (isNaN(dateA)) return 1;
                    if (isNaN(dateB)) return -1;
                    return dateA - dateB;
                });

                filterTable();
            }, (error) => {
                loadingIndicator.classList.add('hidden');
                displayError(`Error al escuchar datos: ${error.message}`);
            });
        }
        
        window.addNewRow = async function() {
            const newGame = {
                title: "Nuevo T√≠tulo (Editable)",
                platforms: "PC, Consola",
                releaseDate: "Pendiente",
                genre: "Indefinido",
                notes: "Escribe aqu√≠ tus notas personales.",
                steamLink: null, ps5Link: null, xboxLink: null, ggDealsLink: null, instantGamingLink: null,
                createdAt: new Date().toISOString()
            };

            if (db) {
                try {
                    await addDoc(getGamesCollectionRef(), newGame);
                } catch (e) {
                    displayError(`Fallo al a√±adir documento: ${e.message}`);
                }
            } else {
               const tempId = crypto.randomUUID();
               gamesData.push({...newGame, id: tempId});
               filterTable();
            }
        }

        window.updateGameField = async function(docId, field, value) {
            if (!db) return console.log("Modo local: El cambio no se guardar√° permanentemente.");
            
            try {
                const docRef = doc(getGamesCollectionRef(), docId);
                await setDoc(docRef, { [field]: value }, { merge: true });
            } catch (e) {
                displayError(`Fallo al actualizar campo: ${e.message}`);
            }
        }
        
        window.deleteGameRow = async function(docId) {
            if (db) {
                try {
                    if (activeDetailsId === docId) {
                        window.toggleDetails(docId);
                    }
                    const docRef = doc(getGamesCollectionRef(), docId);
                    await deleteDoc(docRef);
                } catch (e) {
                    displayError(`Fallo al eliminar documento: ${e.message}`);
                }
            } else {
               gamesData = gamesData.filter(g => g.id !== docId);
               filterTable();
            }
        }

        // --- 4. Interactividad y Renderizado de la UI ---

        const renderLink = (url, text, bgColor, hoverColor) => {
            if (!url) {
                return `<div class="flex items-center space-x-2 p-3 bg-gray-600 rounded-lg opacity-50 cursor-not-allowed">
                            <span class="font-semibold text-gray-400">${text} (No disponible)</span>
                        </div>`;
            }
            return `<a href="${url}" target="_blank" rel="noopener noreferrer" 
                       class="flex items-center space-x-2 p-3 ${bgColor} rounded-lg ${hoverColor} transition duration-200 transform hover:scale-105 shadow-md">
                        <span class="font-semibold text-white">${text}</span>
                    </a>`;
        }

        function renderDetailsPanel(game) {
            return `
                <h2 class="text-3xl font-bold text-indigo-400 mb-4">${game.title} - Enlaces y Detalles</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-gray-900/70 p-4 rounded-lg shadow-xl border border-gray-700">
                        <h3 class="text-xl font-semibold text-gray-300 mb-3 border-b border-gray-700 pb-2">üõí Tiendas Oficiales</h3>
                        <div class="space-y-3">
                            ${renderLink(game.steamLink, 'Steam (PC)', 'bg-gray-700', 'hover:bg-blue-800')}
                            ${renderLink(game.ps5Link, 'PlayStation Store', 'bg-gray-700', 'hover:bg-blue-600')}
                            ${renderLink(game.xboxLink, 'Xbox Store', 'bg-gray-700', 'hover:bg-green-700')}
                        </div>
                    </div>
                    <div class="bg-gray-900/70 p-4 rounded-lg shadow-xl border border-gray-700">
                        <h3 class="text-xl font-semibold text-gray-300 mb-3 border-b border-gray-700 pb-2">üí∞ Comparadores de Precios</h3>
                        <div class="space-y-3">
                            ${renderLink(game.ggDealsLink, 'Ofertas en gg.deals', 'bg-gray-700', 'hover:bg-purple-700')}
                            ${renderLink(game.instantGamingLink, 'Instant Gaming (Keys)', 'bg-gray-700', 'hover:bg-yellow-600')}
                        </div>
                    </div>
                    <div class="md:col-span-2 bg-gray-900/70 p-4 rounded-lg shadow-xl border border-gray-700">
                        <h3 class="text-xl font-semibold text-gray-300 mb-3 border-b border-gray-700 pb-2">üìù Notas</h3>
                        <p class="text-gray-400 italic">${game.notes || 'No hay notas para este juego.'}</p>
                    </div>
                </div>
                <button onclick="window.toggleDetails('${game.id}')" class="mt-6 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg shadow-lg transition duration-200">
                    Cerrar Detalles
                </button>
            `;
        }

        window.toggleDetails = function(gameId) {
            const detailsPanel = document.getElementById('details-panel');
            const selectedGame = gamesData.find(g => g.id === gameId);

            if (!selectedGame) return displayError("Juego no encontrado para mostrar detalles.");
            
            if (activeDetailsId === gameId) {
                detailsPanel.classList.add('hidden');
                detailsPanel.innerHTML = '';
                activeDetailsId = null;
            } else {
                detailsPanel.innerHTML = renderDetailsPanel(selectedGame);
                detailsPanel.classList.remove('hidden');
                detailsPanel.classList.add('details-panel-enter');
                activeDetailsId = gameId;
                detailsPanel.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        function renderTable(dataToRender) {
            const tableBody = document.getElementById('game-table-body');
            tableBody.innerHTML = '';

            if (dataToRender.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="6" class="p-6 text-center text-gray-500">No se encontraron juegos que coincidan con la b√∫squeda.</td></tr>`;
                return;
            }

            dataToRender.forEach(game => {
                const row = document.createElement('tr');
                row.classList.add('data-row', 'transition', 'duration-150');

                const createEditableCell = (field, content, isTitle = false) => {
                    const cell = document.createElement('td');
                    cell.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-sm');
                    if (isTitle) {
                        cell.classList.add('title-cell');
                        cell.onclick = () => window.toggleDetails(game.id);
                    } else {
                        cell.classList.add('text-gray-300');
                        cell.setAttribute('contenteditable', 'true');
                        cell.onblur = (e) => {
                            const newValue = e.target.textContent;
                            if (newValue !== game[field]) {
                                window.updateGameField(game.id, field, newValue);
                            }
                        };
                    }
                    cell.textContent = content;
                    return cell;
                };

                // Celda especial para el t√≠tulo que no es editable pero s√≠ clicable
                const titleCell = createEditableCell('title', game.title, true);

                // Celdas editables
                const platformsCell = createEditableCell('platforms', game.platforms);
                const releaseDateCell = createEditableCell('releaseDate', game.releaseDate);
                const genreCell = createEditableCell('genre', game.genre);
                const notesCell = createEditableCell('notes', game.notes);

                // Celda para el bot√≥n de eliminar
                const deleteCell = document.createElement('td');
                deleteCell.classList.add('px-6', 'py-4', 'text-center');
                const deleteButton = document.createElement('button');
                deleteButton.innerHTML = '‚ùå';
                deleteButton.classList.add('text-lg', 'hover:scale-125', 'transition-transform', 'duration-150');
                deleteButton.onclick = () => deleteGameRow(game.id);
                deleteCell.appendChild(deleteButton);
                
                row.append(titleCell, platformsCell, releaseDateCell, genreCell, notesCell, deleteCell);
                tableBody.appendChild(row);
            });
        }

        window.filterTable = function() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const filteredData = gamesData.filter(game => 
                game.title.toLowerCase().includes(searchTerm) || 
                game.platforms.toLowerCase().includes(searchTerm)
            );
            renderTable(filteredData);
            
            // Si hay un panel de detalles abierto, lo cerramos al filtrar para evitar inconsistencias
            if (activeDetailsId) {
                const detailsPanel = document.getElementById('details-panel');
                detailsPanel.classList.add('hidden');
                detailsPanel.innerHTML = '';
                activeDetailsId = null;
            }
        }
        
        // --- INICIO DE LA APLICACI√ìN ---
        initFirebase();

    </script>
</body>
</html>
